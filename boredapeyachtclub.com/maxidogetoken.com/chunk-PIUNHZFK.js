import{h as _,j as C,k as L,m as H,n as A,o as b,t as D,v as E,w as F}from"./chunk-AMK2IOJV.js";function y(r,t,c,s){if(typeof r.setBigUint64=="function")return r.setBigUint64(t,c,s);let h=BigInt(32),a=BigInt(4294967295),e=Number(c>>h&a),x=Number(c&a),f=s?4:0,o=s?0:4;r.setUint32(t+f,e,s),r.setUint32(t+o,x,s)}function G(r,t,c){return r&t^~r&c}function U(r,t,c){return r&t^r&c^t&c}var B=class extends E{constructor(t,c,s,h){super(),this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.blockLen=t,this.outputLen=c,this.padOffset=s,this.isLE=h,this.buffer=new Uint8Array(t),this.view=A(this.buffer)}update(t){C(this),t=D(t),_(t);let{view:c,buffer:s,blockLen:h}=this,a=t.length;for(let e=0;e<a;){let x=Math.min(h-this.pos,a-e);if(x===h){let f=A(t);for(;h<=a-e;e+=h)this.process(f,e);continue}s.set(t.subarray(e,e+x),this.pos),this.pos+=x,e+=x,this.pos===h&&(this.process(c,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){C(this),L(t,this),this.finished=!0;let{buffer:c,view:s,blockLen:h,isLE:a}=this,{pos:e}=this;c[e++]=128,H(this.buffer.subarray(e)),this.padOffset>h-e&&(this.process(s,0),e=0);for(let i=e;i<h;i++)c[i]=0;y(s,h-8,BigInt(this.length*8),a),this.process(s,0);let x=A(t),f=this.outputLen;if(f%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let o=f/4,d=this.get();if(o>d.length)throw new Error("_sha2: outputLen bigger than state");for(let i=0;i<o;i++)x.setUint32(4*i,d[i],a)}digest(){let{buffer:t,outputLen:c}=this;this.digestInto(t);let s=t.slice(0,c);return this.destroy(),s}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());let{blockLen:c,buffer:s,length:h,finished:a,destroyed:e,pos:x}=this;return t.destroyed=e,t.finished=a,t.length=h,t.pos=x,h%c&&t.buffer.set(s),t}clone(){return this._cloneInto()}},n=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);var I=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),l=new Uint32Array(64),m=class extends B{constructor(t=32){super(64,t,8,!1),this.A=n[0]|0,this.B=n[1]|0,this.C=n[2]|0,this.D=n[3]|0,this.E=n[4]|0,this.F=n[5]|0,this.G=n[6]|0,this.H=n[7]|0}get(){let{A:t,B:c,C:s,D:h,E:a,F:e,G:x,H:f}=this;return[t,c,s,h,a,e,x,f]}set(t,c,s,h,a,e,x,f){this.A=t|0,this.B=c|0,this.C=s|0,this.D=h|0,this.E=a|0,this.F=e|0,this.G=x|0,this.H=f|0}process(t,c){for(let i=0;i<16;i++,c+=4)l[i]=t.getUint32(c,!1);for(let i=16;i<64;i++){let p=l[i-15],u=l[i-2],S=b(p,7)^b(p,18)^p>>>3,g=b(u,17)^b(u,19)^u>>>10;l[i]=g+l[i-7]+S+l[i-16]|0}let{A:s,B:h,C:a,D:e,E:x,F:f,G:o,H:d}=this;for(let i=0;i<64;i++){let p=b(x,6)^b(x,11)^b(x,25),u=d+p+G(x,f,o)+I[i]+l[i]|0,g=(b(s,2)^b(s,13)^b(s,22))+U(s,h,a)|0;d=o,o=f,f=x,x=e+u|0,e=a,a=h,h=s,s=u+g|0}s=s+this.A|0,h=h+this.B|0,a=a+this.C|0,e=e+this.D|0,x=x+this.E|0,f=f+this.F|0,o=o+this.G|0,d=d+this.H|0,this.set(s,h,a,e,x,f,o,d)}roundClean(){H(l)}destroy(){this.set(0,0,0,0,0,0,0,0),H(this.buffer)}};var j=F(()=>new m);export{j as a};
